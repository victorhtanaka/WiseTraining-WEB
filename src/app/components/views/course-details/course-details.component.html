<div class="course-details-container">
  <!-- Botão de Retorno -->
  <div class="back-button">
    <button mat-stroked-button (click)="goBackToCatalog()">
      <mat-icon>arrow_back</mat-icon> Voltar ao Catálogo
    </button>
  </div>

  <!-- Indicador de carregamento -->
  <div *ngIf="isLoading" class="loading-container">
    <mat-spinner diameter="50"></mat-spinner>
    <p>Carregando curso...</p>
  </div>

  <!-- Mensagem de erro -->
  <div *ngIf="!isLoading && errorMessage" class="error-container">
    <mat-icon color="warn">error</mat-icon>
    <h2>{{errorMessage}}</h2>
    <button mat-raised-button color="primary" (click)="goBackToCatalog()">
      Voltar ao Catálogo
    </button>
  </div>

  <!-- Detalhes do curso -->
  <div *ngIf="!isLoading && !errorMessage && course" class="course-content">
    <div class="course-header">
      <!-- Imagem do curso -->
      <div class="course-image">
        <img *ngIf="course.media?.url" [src]="course.media?.url || 'assets/images/course-placeholder.jpg'" [alt]="course.title">
        <img *ngIf="!course.media?.url" src="assets/images/course-placeholder.jpg" alt="Imagem do curso">
      </div>

      <!-- Informações do cabeçalho -->
      <div class="course-header-info">
        <h1>{{course.title}}</h1>
        
        <div class="course-metadata">
          <div *ngIf="course.category">
            <mat-icon>category</mat-icon>
            <span>{{course.category.name}}</span>
          </div>
          
          <div *ngIf="course.language">
            <mat-icon>language</mat-icon>
            <span>{{course.language}}</span>
          </div>
          
          <div>
            <mat-icon>schedule</mat-icon>
            <span>{{course.duration}} minutos</span>
          </div>
        </div>

        <!-- Tags do curso -->
        <div class="course-tags">
          <mat-chip-listbox>
            <mat-chip *ngFor="let tag of course.tags">{{tag.name}}</mat-chip>
          </mat-chip-listbox>
        </div>

        <!-- Preço e botão de compra -->
        <div class="purchase-section">
          <div class="course-price">
            <span>Preço:</span>
            <h2>R$ {{course.price | number:'1.2-2'}}</h2>
          </div>

          <div class="purchase-actions">
            <button 
              *ngIf="!courseOwned" 
              mat-raised-button 
              color="primary" 
              (click)="purchaseCourse()"
              [disabled]="isLoading">
              <mat-icon>shopping_cart</mat-icon>
              Comprar este curso
            </button>
            
            <div *ngIf="courseOwned" class="course-owned">
              <mat-icon color="accent">check_circle</mat-icon>
              <span>Curso já adquirido</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Descrição do curso -->
    <mat-card class="course-description">
      <mat-card-header>
        <mat-card-title>Descrição do Curso</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p>{{course.description}}</p>
      </mat-card-content>
    </mat-card>

    <!-- Conteúdo do curso -->
    <mat-card *ngIf="course.contents && course.contents.length > 0" class="course-content-list">
      <mat-card-header>
        <mat-card-title>Conteúdo do Curso</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <mat-list>
          <mat-list-item *ngFor="let content of course.contents; let i = index">
            <mat-icon mat-list-icon>article</mat-icon>
            <div mat-line>{{i + 1}}. {{content.title}}</div>
            <div mat-line *ngIf="content.textContent">{{content.textContent}}</div>
          </mat-list-item>
        </mat-list>
      </mat-card-content>
    </mat-card>
  </div>
</div>
